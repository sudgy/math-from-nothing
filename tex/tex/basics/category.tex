\documentclass[../../math.tex]{subfiles}
\externaldocument{../../math.tex}
\externaldocument{foundations}
\externaldocument{set}
\externaldocument{lists}

\begin{document}

\setcounter{chapter}{5}

\chapter{Category Theory}

Category theory is the general study of mathematical structures.  It can provide
a unified way of describing many seemingly different aspects of math, and using
it can often simplify many definitions and theorems.  However, I don't actually
know much category theory, so I haven't developed much of it here.  I've mostly
just defined categories, functors, and natural transformations and a few basic
facts about them, and haven't even proven the Yoneda lemma.  I know that there
are many things later on that could be simplified by the use of category theory,
but the fact is I just haven't studied it enough yet.

Another thing that I should point out is that in the Coq code, I am unable to
make arguments using commutative diagrams.  Because this document is supposed to
mirror the Coq code, I will not be using commutative diagrams here either.  This
is not to say that I prefer not using commutative diagrams.  It's just that not
using them makes this document a better representation of the Coq code.

A quick note on the order here: In the Coq code, functors and natural
transformations are defined the moment after categories are.  That's because
it's helpful to have categories be objects in the category of categories, to
have functors be both the morphisms there and the objects in the category of
functors, and to have natural transformations be the morphisms in the category
of functors.  By defining these notions first, they can be used as the
definition of categories, functors, and natural transformations, allowing for
similar notation to be used for all of them.  However, here we don't have to
worry about making sure Coq will know what categories are objects are in, so
I'll present things in a different order here.  Instead, I will define
categories and several of the notions that are definable with just categories,
then functors and their notions after that, and then natural transformations.

\section{Categories}

\begin{definition}
    A Category is a combination of the following things:
    \begin{itemize}
        \item A $\Type$, which we call the objects of the category.  Given a
            particular category $C$, we abuse the notation $A : C$ to mean that
            $A$ is an object in $C$.
        \item A function from objects $A$ and $B$ to a $\Type$ that we call $A
            \to B$, the values of which are called the morphisms from $A$ to
            $B$.  Given a morphism $A \to B$, we call $A$ the domain and $B$ the
            codomain.
        \item A function that takes in objects $A$, $B$, and
            $C$ and morphisms $f : B \to C$ and $g : A \to B$, and produces a
            new morphism $f \circ g : A \to C$, called the composition of $f$
            and $g$.
        \item A function that takes in an object $A$ and produces a morphism
            $\1 : A \to A$ called the identity morphism.  If the object
            $A$ needs to be explicit we will write $\1_A$.
        \item A proof that composition of morphisms is associative, that is, for
            all objects $A$, $B$, $C$, and $D$ and all morphisms $f : C \to D$,
            $g : B \to C$, and $h : A \to B$, we have $f \circ (g \circ h) = (f
            \circ g) \circ h$.
        \item A proof that every identity morphism is a left identity, that is,
            for all objects $A$ and $B$ and morphisms $f : A \to B$, we have
            $\1_B \circ f = f$.
        \item A proof that every identity morphism is a right identity, that is,
            for all objects $A$ and $B$ and morphisms $f : A \to B$, we have
            $f \circ \1_A= f$.
    \end{itemize}
\end{definition}

\begin{definition}
    Given a category $C$ and two objects $A$ and $B$, if $f : A \to B$ and $g :
    B \to A$ are such that $f \circ g = \1$ and $g \circ f = \1$, then we
    say that $f$ and $g$ are inverses.  If $f$ is a morphism such that there
    exists a $g$ such that $f$ and $g$ are inverses, then we call $f$ an
    isomorphism.  If there exists an isomorphism from $A$ to $B$, then we say
    that $A$ and $B$ are isomorphic and we write $A \cong B$.
\end{definition}

\begin{definition}
    Given a category $C$, two objects $A$ and $B$, and a morphism $f : A \to B$,
    if for all objects $Z$ and morphisms $g$ and $h$ in $Z \to A$ we have $g =
    h$ if $f \circ g = f \circ h$, then $f$ is called a monomorphism.
\end{definition}

\begin{definition}
    Given a category $C$, two objects $A$ and $B$, and a morphism $f : A \to B$,
    if for all objects $Z$ and morphisms $g$ and $h$ in $B \to Z$ we have $g =
    h$ if $g \circ f = h \circ f$, then $f$ is called an epimorphism.
\end{definition}

\begin{theorem}
    The identity morphism is an isomorphism.
\end{theorem}
\begin{proof}
    The identity morphism is the inverse.
\end{proof}

\begin{theorem}
    The composition of two isomorphisms is an isomorphism.
\end{theorem}
\begin{proof}
    Let $A$, $B$, and $C$ be objects and let $f : B \to C$ and $g : A \to B$ be
    isomorphisms.  This means that we have morphisms $f' : C \to B$ and $g' : B
    \to A$ such that $f \circ f' = \1$, $f' \circ f = \1$, $g \circ g' = \1$,
    and $g' \circ g = \1$.  Then we have
    \[
        f \circ g \circ g' \circ f' = f \circ f' = \1
    \]
    and
    \[
        g' \circ f' \circ f \circ g = g' \circ g = \1,
    \]
    showing that $g' \circ f'$ is an inverse of $f \circ g$.
\end{proof}

\begin{theorem}
    If a morphism $f$ has two inverses $g_1$ and $g_2$, then $g_1 = g_2$.
\end{theorem}
\begin{proof}
    By definition, we have $f \circ g_1 = \1$.  Composing on the left with $g_2$
    on both sides we get
    \[
        g_2 \circ f \circ g_1 = g_1 = g_2.
    \]
\end{proof}

\begin{theorem}
    Objects being isomorphic is an equivalence relation.
\end{theorem}
\begin{proof}
    Reflexivity follows from the identity morphism being an isomorphism.  For
    symmetry, given an isomorphism $f : A \to B$, the inverse $g : B \to A$ is
    an isomorphism.  Transitivity follows from the composition of isomorphisms
    being an isomorphism.
\end{proof}

\begin{theorem} \label{isomorphism_monomorphism}
    If a morphism is an isomorphism, then it is a monomorphism.
\end{theorem}
\begin{proof}
    Let $f$ be an isomorphism from $A$ to $B$ then it has an inverse $f^{-1} : B
    \to A$.  Then for all morphisms $g$ and $h$ such that $f \circ g = f \circ
    h$, we can apply $f^{-1}$ on the left to get $g = h$.
\end{proof}

\begin{theorem} \label{isomorphism_epimorphism}
    If a morphism is an isomorphism, then it is an epimorphism.
\end{theorem}
\begin{proof}
    The proof is similar in form to the proof of the previous theorem.
\end{proof}

\begin{definition}
    Given a category $C$, we can define its dual category $\dual{C}$ as the
    category with objects the same as $C$, with morphisms from $A$ to $B$ as
    being the morphisms in $C$ from $B$ to $A$, with the composition $f \circ g$
    being the composition $g \circ f$ is $C$, and with identities being the same
    as the identities in $C$.
\end{definition}

\begin{theorem}
    A morphism is an isomorphism if and only if it is an isomorphism in the dual
    category.
\end{theorem}
\begin{proof}
    This follows directly from the symmetry of isomorphism.
\end{proof}

\begin{theorem}
    For all categories $C$, $C = \dual{{\dual{C}}}$.
\end{theorem}
\begin{proof}
    Trivial.
\end{proof}

\begin{definition}
    Given two categories $C_1$ and $C_2$, we define their product $C_1 \times
    C_2$ as the category where the objects are defined to be $C_1 \times C_2$
    (where $C_1$ and $C_2$ are considered to be the objects in this case), the
    morphisms $A \to B$ are defined to be $(P_1(A) \to P_1(B)) \times (P_2(A)
    \to P_2(B))$, the composition of two morphisms $f$ and $g$ is defined to be
    $(P_1(f) \circ P_1(g), P_2(f) \circ P_2(g))$, and the identity morphisms are
    defined to be $(\1, \1)$.
\end{definition}

\begin{definition}
    Given a category $C$, a subcategory of $C$ is subsets $O$ of the objects of
    $C$ and $M$ of the morphisms of $C$ such that the composition of morphisms
    in $M$ is in $M$ and that all identity morphisms are in $M$.  A subcategory
    is trivially a category formed with $\T(O)$ and $\T(M)$.
\end{definition}

\begin{definition}
    A subcategory is called a full subcategory if for all objects $A$ and $B$,
    $M(A, B) = \mathbf U$.
\end{definition}

\begin{definition}
    An object $A$ of a category $C$ is called an initial object in $C$ if for
    all objects $B : C$, $A \to B$ is a singleton type.  Similarly, $A$ is
    called a terminal object in $C$ if for all objects $B : C$, $B \to A$ is a
    singleton type.
\end{definition}

\begin{theorem} \label{initial_unique}
    All initial objects in a category are isomorphic to each other.
\end{theorem}
\begin{proof}
    Let $I_1$ and $I_2$ be two initial objects.  Then by them being initial, we
    have morphisms $f : I_1 \to I_2$ and $g : I_2 \to I_1$.  Then because $I_2$
    is initial, all morphisms in $I_2 \to I_2$ are the same, meaning that $f
    \circ g = \1$.  Similarly, $g \circ f = \1$, showing that $I_1 \cong I_2$.
\end{proof}

\begin{theorem} \label{terminal_unique}
    All terminal objects in a category are isomorphic to each other.
\end{theorem}
\begin{proof}
    This is the dual version of the previous theorem.
\end{proof}

\section{Functors}

\begin{definition}
    Given two categories $C_1$ and $C_2$, a functor $F$ from $C_1$ to $C_2$ is a
    combination of the following things:
    \begin{itemize}
        \item A function $C_1 \to C_2$, which will be denoted by treating the
            functor $F$ itself as a function.  For example, if $A : C_1$, then
            $F(A) : C_2$.
        \item For all objects $A$ and $B$ in $C_1$, a function from $A \to B$ to
            $F(A) \to F(B)$.  Again, this will be denoted by treating $F$ as a
            function, so if we have a morphism $f : A \to B$, then $F(f) : F(A)
            \to F(B)$.  Thus, functors will be used to represent two different
            functions that must be determined from context.  If we want to talk
            about the function taking morphisms from $A$ to $B$ to morphisms
            from $F(A)$ to $F(B)$ itself, we will use $F_{A,B}$.
        \item A proof that for all objects $A$, $B$, and $C$ in $C_1$ and
            morphisms $f : B \to C$ and $g : A \to B$, we have $F(f \circ g) =
            F(f) \circ F(g)$.
        \item A proof that for all objects $A : C_1$, we have $F(\1_A) =
            \1_{F(A)}$.
    \end{itemize}
\end{definition}

\begin{theorem}
    Given a category $C$, the identity map on both objects and morphisms is a
    functor that we call the identity functor.
\end{theorem}
\begin{proof}
    Trivial.
\end{proof}

\begin{theorem}
    Given three categories $C_1$, $C_2$, and $C_3$ and two functors $F : C_2 \to
    C_3$ and $G : C_1 \to C_2$, the functions $F(G(A))$ and $F(G(f))$ are a
    functor that we call the composition of $F$ and $G$.
\end{theorem}
\begin{proof}
    As for composition,
    \[
        F(G(f \circ g)) = F(G(f) \circ G(g)) = F(G(f)) \circ F(G(g)).
    \]
    As for the identity,
    \[
        F(G(\mathds 1)) = F(\mathds 1) = \mathds 1.
    \]
\end{proof}

\begin{theorem}
    Categories form a category \Cat where the objects are categories, the
    morphisms are functors between them, composition of functors is as defined
    above, and the identity functor is as defined above.
\end{theorem}
\begin{proof}
    Composition of functors is associative by the associativity of function
    composition.  The identity functor is an identity because it is defined to
    be the identity function.
\end{proof}

Thus, without confusion we may use the notation $\1$ to represent the
identity functor and $F \circ G$ to represent the composition of two functors.

\begin{theorem}
    Functors preserve isomorphisms, that is, if $F$ is a functor and $A \cong
    B$, then $F(A) \cong F(B)$.
\end{theorem}
\begin{proof}
    Because $A \cong B$, there exist morphisms $f : A \to B$ and $g : B \to A$
    such that $f \circ g = \1$ and $g \circ f = \1$.  Then we have
    \[
        F(f) \circ F(g) = F(f \circ g) = F(\1) = \1
    \]
    and
    \[
        F(g) \circ F(f) = F(g \circ f) = F(\1) = \1,
    \]
    showing that $F(f)$ and $F(g)$ are inverses.  Thus, $F(A) \cong F(B)$.
\end{proof}

\begin{definition}
    A functor $F$ is faithful if for all objects $A$ and $B$, $F_{A,B}$ is
    injective.
\end{definition}

\begin{definition}
    A functor $F$ is full if for all objects $A$ and $B$, $F_{A,B}$ is
    surjective.
\end{definition}

\begin{definition}
    A functor $F : C_1 \to C_2$ is essentially surjective if for all objects $B
    : C_2$, there exists an $A : C_1$ such that $F(A) \cong B$.
\end{definition}

\begin{theorem}
    The identity functor is faithful.
\end{theorem}
\begin{proof}
    This follows from the identity function being injective.
\end{proof}

\begin{theorem}
    The identity functor is full.
\end{theorem}
\begin{proof}
    This follows from the identity function being surjective.
\end{proof}

\begin{definition}
    Given a category $C$ and a subcategory $S$, the maps taking objects and
    morphisms from $S$ to $C$ is a functor called the inclusion functor.
\end{definition}

\begin{theorem}
    The inclusion functor is faithful.
\end{theorem}
\begin{proof}
    This follows from Theorem \ref{set_type_inj}.
\end{proof}

\begin{theorem}
    If $S$ is a full subcategory of $C$, then the inclusion functor from $S$ to
    $C$ is full.
\end{theorem}
\begin{proof}
    Let $f$ be a morphism in $S$ from objects $A$ to $B$.  We must prove that
    $f$ is a morphism in $C$ as well.  This follows from $S$ being a full
    subcategory of $C$.
\end{proof}

\section{Natural Transformations}

\begin{definition}
    Given two categories $C_1$ and $C_2$ and two functors $F$ and $G$ from $C_1$
    to $C_2$, a natural transformation $\alpha : F \to G$ is a combination of
    the following things:
    \begin{itemize}
        \item A function from objects $A : C_1$ to morphisms $F(A) \to G(A)$,
            which will be denoted $\alpha(A)$.  The image of this function is
            called the components of $\alpha$.
        \item A proof that for all objects $A$ and $B$ in $C_1$ and morphisms $f
            : A \to B$, we have $\alpha(B) \circ F(f) = G(f) \circ \alpha(A)$.
    \end{itemize}
\end{definition}

\begin{theorem}
    Given categories $C_1$ and $C_2$ and a functor $F : C_1 \to C_2$, the
    function that takes objects $A : C_1$ to $\1_{F(A)}$ is a natural
    transformation from $F$ to $F$ called the identity natural transformation.
\end{theorem}
\begin{proof}
    We mult prove that for all objects $A$ and $B$ in $C_1$ and morphisms $f : A
    \to B$, we have $\1 \circ F(f) = F(f) \circ \1$, which follows from $\1$
    being an identity.
\end{proof}

\begin{theorem}
    Given categories $C_1$ and $C_2$, functors $F$, $G$, and $H$ from $C_1$
    to $C_2$, and natural transformations $\alpha : G \to H$ and $\beta : F \to
    G$, the function taking objects $A : C_1$ to $\alpha(A) \circ \beta(A)$ is a
    natural transformation from $F$ to $H$ that we call the vertical composition
    of $\alpha$ and $\beta$.
\end{theorem}
\begin{proof}
    \[
        \alpha(B) \circ \beta(B) \circ F(f) =
        \alpha(B) \circ G(f) \circ \beta(A) =
        H(f) \circ \alpha(A) \circ \beta(A).
    \]
\end{proof}

\begin{theorem}
    Given two categories $C_1$ and $C_2$, functors form a category $\Fct(C_1,
    C_2)$ where the objects are functors from $C_1$ to $C_2$, the morphisms are
    natural transformations between them, composition of natural transformations
    is as defined above, and the identity natural transformation is as defined
    above.
\end{theorem}
\begin{proof}
    Every property needed follows from the corresponding property in $C_2$.
\end{proof}

Thus, like with functors, without confusion we may use the notation $\1$
to represent the identity natural transformation and $\alpha \circ \beta$ to
represent the vertical composition of two natural transformations.

\begin{theorem}
    Given three categories $C_1$, $C_2$, and $C_3$, four functors $F_1$ and
    $G_1$ from $C_1$ to $C_2$ and $F_2$ and $G_2$ from $C_2$ to $C_3$, and two
    natural transformations $\alpha : F_1 \to G_1$ and $\beta : F_2 \to G_2$,
    the function given by \[
        (\beta \ocircle \alpha)(A : C_1) = \beta(G_1(A)) \circ F_2(\alpha(A))
    \]
    is a natural transformation from $F_2 \circ F_1$ to $G_2 \circ G_1$ that we
    call the horizontal composition of $\beta$ and $\alpha$.
\end{theorem}
\begin{proof}
    For all objects $A$ and $B$ and morphisms $f : A \to B$,
    \begin{align*}
         {}& \beta(G_1(B)) \circ F_2(\alpha(B)) \circ F_2(F_1(f)) \\
        ={}& \beta(G_1(B)) \circ F_2(\alpha(B) \circ F_1(f)) \\
        ={}& G_2(\alpha(B) \circ F_1(f)) \circ \beta(F_1(A)) \\
        ={}& G_2(G_1(f) \circ \alpha(A)) \circ \beta(F_1(A)) \\
        ={}& G_2(G_1(f)) \circ G_2(\alpha(A)) \circ \beta(F_1(A)) \\
        ={}& G_2(G_1(f)) \circ \beta(G_1(A)) \circ F_2(\alpha(A)).
    \end{align*}
\end{proof}

\begin{theorem} \label{nat_trans_interchange}
    For all categories $C_1$, $C_2$, and $C_3$, functors $F_1$, $G_1$, and $H_1$
    from $C_1$ to $C_2$ and $F_2$, $G_2$, and $H_2$ from $C_2$ to $C_3$, and
    natural transformations $\alpha_1 : F_1 \to G_1$, $\beta_1 : G_1 \to H_1$,
    $\alpha_2 : F_2 \to G_2$, and $\beta_2 : G_2 \to H_2$,
    \[
        (\beta_2 \circ \alpha_2) \ocircle (\beta_1 \circ \alpha_1) =
        (\beta_2 \ocircle \beta_1) \circ (\alpha_2 \ocircle \alpha_1).
    \]
\end{theorem}
\begin{proof}
    Let $A : C_1$.  Then
    \begin{align*}
         {}& ((\beta_2 \circ \alpha_2) \ocircle (\beta_1 \circ \alpha_1))(A) \\
        ={}& (\beta_2 \circ \alpha_2)(H_1(A))
            \circ F_2((\beta_1 \circ \alpha_1)(A)) \\
        ={}& \beta_2(H_1(A)) \circ \alpha_2(H_1(A))
            \circ F_2(\beta_1(A) \circ \alpha_1(A)) \\
        ={}& \beta_2(H_1(A)) \circ \alpha_2(H_1(A))
            \circ F_2(\beta_1(A)) \circ F_2(\alpha_1(A)) \\
        ={}& \beta_2(H_1(A)) \circ G_2(\beta_1(A))
            \circ \alpha_2(G_1(A)) \circ F_2(\alpha_1(A)) \\
        ={}& (\beta_2 \ocircle \alpha_1)(A)
            \circ (\alpha_2 \ocircle \alpha_1)(A) \\
        ={}& ((\beta_2 \ocircle \alpha_1)
            \circ (\alpha_2 \ocircle \alpha_1))(A).
    \end{align*}
\end{proof}

\begin{theorem}
    For all categories $C_1$, $C_2$, and $C_3$ and functors $F : C_2 \to C_3$
    and $G : C_1 \to C_2$,
    \[
        \1_F \ocircle \1_G = \1_{F \circ G}.
    \]
\end{theorem}
\begin{proof}
    For all objects $A : C_1$,
    \[
        (\1_F \ocircle \1_G)(A)
        = \1(G(A)) \circ F(\1(A))
        = \1 \circ F(\1)
        = \1
        = \1(A).
    \]
\end{proof}

\begin{definition}
    If a natural transformation is an isomorphism in the category of functors,
    then we say that it is a natural isomorphism, and that those two functors
    are naturally isomorphic.
\end{definition}

\begin{theorem} \label{nat_isomorphism_components}
    A natural transformation $\alpha$ is an isomorphism if and only if the
    components of $\alpha$ are all isomorphisms.
\end{theorem}
\begin{proof}
    Let $C_1$ and $C_2$ be categories with functors $F$ and $G$ from $C_1$ to
    $C_2$, and let $\alpha : F \to G$.

    First assume that $\alpha$ is a natural isomorphism and let $A : C_1$.  We
    must find an inverse morphism to $\alpha(A)$.  Because $\alpha$ is a natural
    isomorphism, there exists a $\beta$ such that $\alpha \circ \beta = \1$ and
    $\beta \circ \alpha = \1$.  Now
    \[
        \alpha(A) \circ \beta(A) = (\alpha \circ \beta)(A) = \1(A) = \1,
    \]
    and similarly for $\beta(A) \circ \alpha(A)$, so $\beta(A)$ is the inverse
    of $\alpha(A)$, showing that $\alpha(A)$ is an isomorphism.

    Now assume that that all of the components of $\alpha$ are isomorphisms.
    Let $\beta : G \to F$ be given by $\beta(A) = \text{inverse of
    $\alpha(A)$}$.  Then for all objects $A$ and $B$ in $C_1$ and morphisms $f :
    A \to B$,
    \begin{align*}
         {}& \beta(B) \circ G(f) \\
        ={}& \beta(B) \circ G(f) \circ \alpha(A) \circ \beta(A) \\
        ={}& \beta(B) \circ \alpha(B) \circ F(f) \circ \beta(A) \\
        ={}& F(f) \circ \beta(A),
    \end{align*}
    showing that $\beta$ is a natural transformation.  Then by definition,
    $\alpha \circ \beta = \1$ and $\beta \circ \alpha = \1$, showing that
    $\alpha$ is a natural ismorphism.
\end{proof}

\begin{theorem}
    Given categories $C_1$, $C_2$, and $C_3$, and functors $F$ and $G$ from
    $C_2$ to $C_3$ and functors $H$ and $I$ from $C_1$ to $C_2$, if $F \cong G$
    and $H \cong I$, then $F \circ H \cong G \circ I$.
\end{theorem}
\begin{proof}
    Let $\alpha_1 : F \to G$ and $\alpha_2 : G \to F$ be inverses, and let
    $\beta_1 : H \to I$ and $\beta_2 : I \to H$ be inverses.  We will prove that
    $\alpha_1 \ocircle \beta_1$ and $\alpha_2 \ocircle \beta_2$ are inverses.
    By Theorem \ref{nat_trans_interchange},
    \[
        (\alpha_1 \ocircle \beta_1) \circ (\alpha_2 \ocircle \beta_2)
        = (\alpha_1 \circ \alpha_2) \ocircle (\beta_1 \circ \beta_2)
        = \1 \ocircle \1 = \1.
    \]
    Similarly,
    \[
        (\alpha_2 \ocircle \beta_2) \circ (\alpha_1 \ocircle \beta_1)
        = (\alpha_2 \circ \alpha_1) \ocircle (\beta_2 \circ \beta_1)
        = \1 \ocircle \1 = \1.
    \]
    Thus, $F \circ H \cong G \circ I$.
\end{proof}

\begin{definition}
    Given two categories $C_1$ and $C_2$, we say that they are equivalent if
    there exist functors $F : C_1 \to C_2$ and $G : C_2 \to C_1$ such that there
    exist natural isomorphisms $\eta : \1 \to G \circ F$ and $\varepsilon : F
    \circ G \to \1$.  If two categories $C_1$ and $C_2$ are equivalent, we write
    $C_1 \simeq C_2$.
\end{definition}

\begin{theorem}
    Equivalence of categories is an equivalence relation.
\end{theorem}
\begin{proof}
    For reflexivity, the identity functors and identity natural transformations
    work.  For symmetry, given functors $F : C_1 \to C_2$ and $G : C_2 \to C_1$
    such that $\1 \cong G \circ F$ and $F \circ G \cong \1$, we have $\1 \cong F
    \circ G$ and $G \circ F \cong \1$, showing that $G$ and $F$ are the functors
    needed to show that $C_2 \simeq C_1$.

    Transitivity takes just a bit more work.  Let $C_1$, $C_2$, and $C_3$ be
    categories such that there exist functors $F_1 : C_1 \to C_2$, $G_1 : C_2
    \to C_1$, $F_2 : C_2 \to C_3$, and $G_2 : C_3 \to C_2$ such that $\1 \cong
    G_1 \circ F_1$, $F_1 \circ G_1 \cong \1$, $\1 \cong G_2 \circ F_2$, and $F_2
    \circ G_2 \cong \1$.  We have
    \begin{align*}
        \1 &\cong G_2 \circ F_2 \\
        G_1 \circ F_1 &\cong G_1 \circ G_2 \circ F_2 \circ F_1,
    \end{align*}
    and with $\1 \cong G_1 \circ F_1$, by transitivity we have $\1 \cong G_1
    \circ G_2 \circ F_2 \circ F_1$.  Similarly,
    \begin{align*}
        F_1 \circ G_1 &\cong \1 \\
        F_2 \circ F_1 \circ G_1 \circ G_2 &\cong F_2 \circ G_2,
    \end{align*}
    and with $F_2 \circ G_2 \circ \1$, by transitivity we have $F_2
    \circ F_1 \circ G_1 \circ G_2 \cong \1$.  Thus, we see that $F_2 \circ F_1$
    and $G_1 \circ G_2$ are the functors needed to shaw that $C_1 \simeq C_3$.
\end{proof}

\begin{theorem}
    A functor $F : C_1 \to C_2$ is a part of an equivalence if and only if it is
    full, faithful, and essentially surjective.
\end{theorem}
\begin{proof}
    First, assume that there exist functors $F : C_1 \to C_2$ and $G : C_2 \to
    C_1$ such that $\1 \cong G \circ F$ and $F \circ G \cong \1$.  We will prove
    that $F$ is full, faithful, and essentially surjective.  Because equivalence
    of categories is symmetric, the results will hold for $G$ as well.

    To prove that $F$ is faithful, we must prove that for all objects $A$ and
    $B$ and morphisms $f$ and $g$ from $A$ to $B$, if $F(f) = F(g)$, then $f =
    g$.  Because $F(f) = F(g)$, we have $G(F(f)) = G(F(g))$.  Because $\1 \cong
    G \circ F$, we have a natural isomorphism $\eta : \1 \to G \circ F$.  By
    naturality of $\eta$, we have
    \[
        \eta(B) \circ f = G(F(f)) \circ \eta(A)
    \]
    and
    \[
        \eta(B) \circ g = G(F(g)) \circ \eta(A).
    \]
    Combining these results with $G(F(f)) = G(F(g))$, we get
    \[
        \eta(B) \circ f = \eta(B) \circ g.
    \]
    By Theorem \ref{nat_isomorphism_components}, $\eta(B)$ is an isomorphism, so
    we can cancel it to show that $f = g$.

    To show that $F$ is essentially surjective, let $B : C_2$.  We must prove
    that there exists an $A : C_1$ such that $F(A) \cong B$.  We will show that
    $A = G(B)$ is the correct choice.  Because $F \circ G \cong \1$, we have a
    natural isomorphism $\varepsilon : F \circ G \to \1$.  By Theorem
    \ref{nat_isomorphism_components}, $\varepsilon(B)$ is an isomorphism from
    $F(G(B))$ to $B$, showing that $F(G(B)) \cong B$, as required.

    To show that $F$ is full, let $A$ and $B$ be objects in $C_1$ and let $f :
    F(A) \to F(B)$.  We must show that there exists a morphism $f' : A \to B$
    such that $F(f') = f$.  Because $\1 \cong G \circ F$, we have a natural
    isomorphism $\eta : \1 \to G \circ F$.  By Theorem
    \ref{nat_isomorphism_components}, $\eta(A)$ and $\eta(B)$ are both
    isomorphisms, so we have morphisms $g : G(F(A)) \to A$ and $h : G(F(B)) \to
    B$ such that
    \begin{align*}
        \eta(A) \circ g &= \1, \\
        g \circ \eta(A) &= \1, \\
        \eta(B) \circ h &= \1, \\
        \intertext{and}
        h \circ \eta(B) &= \1. \\
    \end{align*}
    Then
    \begin{align*}
        G(f) &= \eta(B) \circ h \circ G(f) \\
        &= G(F(h)) \circ \eta(G(F(B)) \circ G(f) \\
        &= G(F(h)) \circ G(F(G(f))) \circ \eta(G(F(A))) \\
        &= G(F(h)) \circ G(F(G(f))) \circ \eta(G(F(A))) \circ \eta(A) \circ g \\
        &= G(F(h)) \circ G(F(G(f))) \circ G(F(\eta(A)))) \circ \eta(A) \circ g \\
        &= G(F(h)) \circ G(F(G(f))) \circ G(F(\eta(A)))) \\
        &= G(F(h \circ G(f) \circ \eta(A))).
    \end{align*}
    Because $G$ is faithful (by the first part of this proof), we get
    \[
        F(h \circ G(f) \circ \eta(A)) = f,
    \]
    showing that $h \circ G(f) \circ \eta(A)$ is the morphism required to show
    that $F$ is full.

    We will now prove the converse.  Let $C_1$ and $C_2$ be categories such that
    there is a functor $F : C_1 \to C_2$ that is full, faithful, and essentially
    surjective.

    We must first define a functor $G : C_2 \to C_1$.  For objects $B : C_2$, we
    will define $G(B)$ to be an object $A$ such that $F(A) \cong B$ as
    guaranteed by $F$ being essentially surjective.  We will also define
    functions $g : C_2 \to (A \to F(G(A)))$ and $g^{-1} : C_2 \to (F(G(A)) \to
    A)$ which are the morphisms of the isomorphism between $A$ and $F(G(A))$.
    Then for objects $A$ and $B$ in $C_2$ and morphisms $f : A \to B$, we will
    define $G(f)$ to be a morphism such that $F(G(f)) = g(B) \circ f \circ
    g^{-1}(A)$ as guaranteed by $F$ being full.  To prove that $G$ is a functor,
    we must prove that it respects compositions and identities.

    To prove that $G$ respects compositions, let $A$, $B$, and $C$ be objects in
    $C_2$ and $f_1 : B \to C$ and $f_2 : A \to B$ be morphisms.  Then we have
    \[
        g(C) \circ f_1 \circ f_2 \circ g^{-1}(A) = g(C) \circ f_1 \circ g^{-1}(B) \circ
        g(B) \circ f_2 \circ g^{-1}(A),
    \]
    so by the definition of $G$, we have
    \[
        F(G(f_1 \circ f_2)) = F(G(f_1)) \circ F(G(f_2))
        = F(G(f_1) \circ G(f_2)).
    \]
    Because $F$ is faithful, we have
    \[
        G(f_1 \circ f_2) = G(f_1) \circ G(f_2)
    \]
    as required.

    To prove that $G$ respects the identity, note that for all objects $A : C_2$
    we have
    \[
        g(A) \circ \1 \circ g^{-1}(A) = \1,
    \]
    so by the definition of $G$ we have
    \[
        F(G(\1)) = \1 = F(\1).
    \]
    Because $F$ is faithful, we get
    \[
        G(\1) = \1
    \]
    as required.

    Now that we have the functor $G : C_2 \to C_1$, we must find natural
    isomorphisms $\eta : \1 \to G \circ F$ and $\varepsilon : F \circ G \to \1$.
    Define $\eta(A)$ to be a morphism such that $F(\eta(A)) = g(F(A))$ as
    guaranteed by $F$ being full.  We must prove that $\eta$ is natural, that
    is, for all objects $A$ and $B$ in $C_1$ and morphisms $f : A \to B$, we
    have
    \[
        \eta(B) \circ f = G(F(f)) \circ \eta(A).
    \]
    First,
    \begin{align*}
        g(F(B)) \circ F(f)
            &= g(F(B)) \circ F(f) \circ g^{-1}(F(A)) \circ g(F(A)) \\
                           &= F(G(F(f))) \circ g(F(A)) \\
        F(\eta(B)) \circ F(f) &= F(G(F(f))) \circ F(\eta(A)) \\
        F(\eta(B) \circ f) &= F(G(F(f)) \circ \eta(A)).
    \end{align*}
    Then because $F$ is faithful, we have
    \[
        \eta(B) \circ f = G(F(f)) \circ \eta(A)
    \]
    as required.

    Define $\varepsilon(A) = g^{-1}(A)$.  Then
    \begin{align*}
        g^{-1}(B) \circ F(G(f))
        &= g^{-1}(B) \circ g(B) \circ f \circ g^{-1}(A) \\
        &= f \circ g^{-1}(A)
    \end{align*}
    showing $\varepsilon$ is natural.

    We will now show that $\eta$ and $\varepsilon$ are isomorphisms, using
    Theorem \ref{nat_isomorphism_components}.  For $\eta$, let $A : C_1$.
    Because $F$ is full, there exists a morphism $f$ such that $F(f) =
    g^{-1}(F(A))$.  Then
    \begin{align*}
        g(F(A)) \circ g^{-1}(F(A)) &= \1 \\
        F(\eta(A)) \circ F(f) &= \1 \\
        F(\eta(A) \circ f) &= F(\1),
    \end{align*}
    and because $F$ is faithful, we have $\eta(A) \circ f = \1$.  Practically
    the same argument shows that $f \circ \eta(A) = \1$ as well, showing that
    $\eta(A)$ is an isomorphism.

    For $\varepsilon$, let $A : C_2$.  Then because $\varepsilon(A) =
    g^{-1}(A)$, $g(A)$ is the inverse of $\varepsilon(A)$, showing that
    $\varepsilon(A)$ is an isomorphism.
\end{proof}

\section{Products and Coproducts}

Throughout this section, let $C$ be a category and $A$ and $B$ be objects.

\subsection{Products}

\begin{definition}
    Define a category $C_{AB}$ where the objects are objects $P : C$ with
    morphisms $\pi_{P1} : P \to A$ and $\pi_{P2} : P \to B$.  The morphisms in
    $C_{AB}$ are morphisms $h : P_1 \to P_2$ such that
    \[
        \pi_{P_2 1} \circ h = \pi_{P_1 1}
    \]
    and
    \[
        \pi_{P_2 2} \circ h = \pi_{P_1 2}.
    \]
    The composition of these morphisms is the composition of the underlying
    morphism, and the identity morphism is the identity morphism in $C$.
\end{definition}
\begin{proof}[Proof that this definition does define a category]
    There are several things that we must prove: that the composition of two
    morphisms and the identity morphisms still satisfy the necessary
    requirements for morphisms in this category, that composition is
    associative, and that the identity morphisms are identities.

    First, let $a$, $b$, and $c$ be objects in $C_{AB}$, and let $f : b \to c$
    and $g : a \to b$ such that
    \begin{align*}
        \pi_{c1} \circ f &= \pi_{b1}, \\
        \pi_{c2} \circ f &= \pi_{b2}, \\
        \pi_{b1} \circ g &= \pi_{a1}, \\
    \intertext{and}
        \pi_{b2} \circ g &= \pi_{a2}.
    \end{align*}
    Then
    \[
        \pi_{c1} \circ f \circ g = \pi_{b2} \circ g = \pi_{a1}
    \]
    and
    \[
        \pi_{c2} \circ f \circ g = \pi_{b2} \circ g = \pi_{a1},
    \]
    showing that $f \circ g$ is a morphisms in $C_{AB}$.

    Now let $f : C_{AB}$.  Then
    \[
        \pi_{f1} \circ \1 = \pi_{f1}
    \]
    and
    \[
        \pi_{f2} \circ \1 = \pi_{f2},
    \]
    so $\1$ is a morphism in $C_{AB}$.

    That composition of morphisms is associative and that $\1$ is an identity in
    $C_{AB}$ follows from the same facts in $C$.
\end{proof}

\begin{class}
    If, for every pair of objects $A$ and $B$ in $C$, there exists an object $A
    \prod B : C_{AB}$ that is a terminal object in $C_{AB}$, we say that $C$ has
    products.  That $A \prod B$ is terminal in $C_{AB}$ will be called the
    universal property of $A \prod B$.
\end{class}

Note that the notation for products here is $A \prod B$, not $A \times B$.  This
is mainly because I wanted to reserve $\times$ for other uses in the Coq code,
and I'm just being consistent here.

While the above definition of products is snappy, it can be confusing having to
deal with both $C$ and $C_{AB}$.  Thus, from now on, we will consider products
$A \prod B$ to be objects in $C$, not $C_{AB}$, and we also have morphisms
$\pi_{1AB} : A \prod B \to A$ and $\pi_{2AB} : A \prod B \to B$.  If the objects
$A$ and $B$ are obvious from context, they will just be called $\pi_1$ and
$\pi_2$.

It's not clear how exactly the universal property, as it is currently stated,
can be used, so here's a couple special cases:

\begin{theorem} \label{product_f} \label{product_f1} \label{product_f2}
    For any $P : C$ and morphisms $p_1 : P \to A$ and $p_2 : P \to B$, there
    exists a morphism $f : P \to A \prod B$ such that $\pi_1 \circ f = p_1$ and
    $\pi_2 \circ f = p_2$.
\end{theorem}
\begin{proof}
    This follows directly from the universal property of $A \prod B$.
\end{proof}

\begin{theorem} \label{product_f_uni} \label{product_f_uni2}
    For any $P$ with morphisms $p_1 : P \to A$ and $p_2 : P \to B$, for all
    morphisms $f$ and $g$ in $P \to A \prod B$, if $\pi_1 \circ f = p_1$, $\pi_2
    \circ f = p_2$, $\pi_1 \circ g = p_1$, and $\pi_2 \circ g = p_2$, then $f =
    g$.
\end{theorem}
\begin{proof}
    This follows directly from the universal property of $A \prod B$.
\end{proof}

\begin{theorem} \label{product_unique}
    For any $P : C$ with morphisms $p_1 : P \to A$ and $p_2 : P \to B$, if for
    all other $P' : C$ with morphisms $p_1' : P' \to A$ and $p_2' : P \to B$,
    there exists exactly one morphism $h : P' \to P$ such that $p_1 \circ h =
    p_1'$ and $p_2 \circ h = p_2'$, then there exists an isomorphism pair $f : P
    \to A \prod B$ and $g : A \prod B \to P$ such that
    \begin{align*}
        \pi_1 \circ f &= p_1, \\
        \pi_2 \circ f &= p_2, \\
        p_1 \circ g &= \pi_1, \\
    \intertext{and}
        p_2 \circ g &= \pi_2.
    \end{align*}
\end{theorem}
\begin{proof}
    The condition in the theorem is precisely the statement that $P$ along with
    $p_1$ and $p_2$ is terminal in $C_{AB}$, so the result follows from Theorem
    \ref{terminal_unique}.
\end{proof}

\begin{theorem} \label{product_mono}
    For all objects $Z : C$ and morphisms $f$ and $g$ in $Z \to A \prod B$,
    if
    \[
        \pi_1 \circ f = \pi_1 \circ g
    \]
    and
    \[
        \pi_2 \circ f = \pi_2 \circ g,
    \]
    then $f = g$.
\end{theorem}
\begin{proof}
    Consider $Z$ with the morphisms $\pi_1 \circ f$ and $\pi_2 \circ f$.  Then
    by Theorem \ref{product_f_uni2}, $f = g$.
\end{proof}

\begin{theorem} \label{product_comm}
    There exists an isomorphism pair $f : A \prod B \to B \prod A$ and $g : B
    \prod A \to A \prod B$ such that
    \begin{align*}
        \pi_{2BA} \circ f &= \pi_{1AB}, \\
        \pi_{1BA} \circ f &= \pi_{2AB}, \\
        \pi_{2AB} \circ g &= \pi_{2BA}, \\
    \intertext{and}
        \pi_{1AB} \circ g &= \pi_{1BA}.
    \end{align*}
\end{theorem}
\begin{proof}
    We will prove that $B \prod A$ along with $\pi_{2BA}$ and $\pi_{1BA}$
    satisfies the conditions of Theorem \ref{product_unique}, from which the
    result directly follows.  Let $P : C$ and let $p_1 : P \to A$ and $p_2 : P
    \to B$ be morphisms.  We must prove that there is exactly one morphism $f :
    P \to B \prod A$ such that $\pi_{2BA} \circ f = p_1$ and $\pi_{1BA} \circ f
    = p_2$.  We will prove existence and uniqueness separately.

    For existence, by the universal property of $B \prod A$, we have a morphism
    $f : P \to B \prod A$ such that
    \[
        \pi_{2BA} \circ f = p_1
    \]
    and
    \[
        \pi_{1BA} \circ f = p_2,
    \]
    showing that there exists a morphism from $P$ to $BA$.

    For uniqueness, let $a$ and $b$ be morphisms in $P \to B \prod A$ such that
    \begin{align*}
        \pi_{2BA} \circ a &= p_1, \\
        \pi_{1BA} \circ a &= p_2, \\
        \pi_{2BA} \circ b &= p_1, \\
    \intertext{and}
        \pi_{1BA} \circ b &= p_2.
    \end{align*}
    By Theorem \ref{product_f_uni2}, $a = b$.
\end{proof}

\begin{theorem} \label{product_assoc}
    Let $\mathcal C$ be a category and $A$, $B$, and $C$ be objects in $\mathcal
    C$.  Then there exists an isomorphism pair $f : A \prod (B \prod C) \to (A
    \prod B) \prod C$ and $g : (A \prod B) \prod C \to A \prod (B \prod C)$ such
    that
    \begin{align*}
        \pi_{1AB} \circ \pi_{1(A \prod B) C} \circ f &= \pi_{1A(B \prod C)}, \\
        \pi_{2AB} \circ \pi_{1(A \prod B) C} \circ f
            &= \pi_{1BC} \circ \pi_{2A(B \prod C)}, \\
        \pi_{2(A \prod B) C} \circ f &= \pi_{2BC} \circ \pi_{2A(B \prod C)}, \\
        \pi_{1A(B \prod C)} \circ g &= \pi_{1AB} \circ \pi_{1(A \prod B) C}, \\
        \pi_{1BC} \circ \pi_{2A(B \prod C)} \circ g
            &= \pi_{2AB} \circ \pi_{1(A \prod B) C}, \\
    \intertext{and}
        \pi_{2BC} \circ \pi_{2A(B \prod C)} \circ g &= \pi_{2(A \prod B) C}.
    \end{align*}
\end{theorem}
\begin{proof}
    Define three new projections
    \begin{align*}
        \pi_1' &= \pi_{1AB} \circ \pi_{1(A \prod B) C}
            : (A \cprod B) \cprod C \to A, \\
        \pi_2' &= \pi_{2AB} \circ \pi_{1(A \prod B) C}
            : (A \cprod B) \cprod C \to B, \\
    \intertext{and}
        \pi_3' &= \pi_{2(A \prod B) C}
            : (A \cprod B) \cprod C \to C.
    \end{align*}
    Using $\pi_2'$ and $\pi_3'$ we can create an object $P_{BC}$ in $\mathcal
    C_{BC}$.  By Theorem \ref{product_f}, there exists a morphism $\pi_{23}' :
    (A \prod B) \prod C \to B \prod C$ such that
    \[
        \pi_{1BC} \circ \pi_{23}' = \pi_2'
    \]
    and
    \[
        \pi_{2BC} \circ \pi_{23}' = \pi_3'.
    \]
    Then using $\pi_1'$ and $\pi_{23}'$, we can create an object $P_{ABC}$ in
    $\mathcal C_{A(B \prod C)}$.  We will show that $P_{ABC}$ is terminal in
    $\mathcal C_{A(B \prod C)}$.  Let $P : \mathcal C$ with morphisms $p_1 : P
    \to A$ and $p_{23} : P \to B \prod C$.  Define
    \[
        p_2 = \pi_{1BC} \circ p_{23} : P \to B
    \]
    and
    \[
        p_3 = \pi_{2BC} \circ p_{23} : P \to C.
    \]
    Using $p_1$ and $p_2$, we can create an object $P_{AB} : \mathcal C_{AB}$.
    By Theorem \ref{product_f}, there exists a morphism $f : P \to (A \prod B)$
    such that
    \[
        \pi_{1AB} \circ f = p_1
    \]
    and
    \[
        \pi_{2AB} \circ f = p_2.
    \]
    By Theorem \ref{product_unique}, it suffices to prove that there exists
    exactly one morphism from $P$ to $P_{ABC}$.  We will do this by proving that
    one exists, and then showing that it's unique.

    For existence, using $f$ and $p_3$, we can create an object $P' : \mathcal
    C_{(A \prod B) C}$.  By Theorem \ref{product_f}, there exists a morphism $g
    : P \to (A \prod B) \prod C$ such that
    \[
        \pi_{1 (A \prod B) C} \circ g = f
    \]
    and
    \[
        \pi_{2 (A \prod B) C} \circ g = p_3.
    \]
    Then
    \begin{equation} \label{product_assoc1}
        \pi_1' \circ g
        = \pi_{1AB} \circ \pi_{1 (A \prod B) C} \circ g
        = \pi_{1AB} \circ f = p_1.
    \end{equation}
    We also have
    \[
        \pi_{1BC} \circ \pi_{23}' \circ g
        = \pi_2' \circ g
        = \pi_{2AB} \circ \pi_{1 (A \prod B) C} \circ g
        = \pi_{2AB} \circ f
        = p_2
        = \pi_{1BC} \circ p_{23}
    \]
    and
    \[
        \pi_{2BC} \circ \pi_{23}' \circ g
        = \pi_3' \circ g
        = \pi_{2 (A \prod B) C} \circ g'
        = \pi_{2BC} \circ p_{23},
    \]
    so by Theorem \ref{product_mono},
    \begin{equation} \label{product_assoc2}
        \pi_{23}' \circ g = p_{23}.
    \end{equation}
    By equations \ref{product_assoc1} and \ref{product_assoc2}, $g$ is a
    morphism from $P$ to $P_{ABC}$.

    For uniqueness, let $a_1$ and $a_2$ be morphisms in $P \to (A \prod B) \prod
    C$ such that
    \[
        \pi_1' \circ a_i = p_1
    \]
    and
    \[
        \pi_{23}' \circ a_i = p_{23}.
    \]
    Then
    \[
        \pi_{1AB} \circ \pi_{1 (A \prod B) C} \circ a_i
        = \pi_1' \circ a_i
        = p_1
        = \pi_{1AB} \circ f
    \]
    and
    \[
        \pi_{2AB} \circ \pi_{1 (A \prod B) C} \circ a_i
        = \pi_2' \circ a_i
        = \pi_{1BC} \circ \pi_{23}' \circ a_i
        = \pi_{1BC} \circ p_{23}
        = p_2
        = \pi_{2AB} \circ f,
    \]
    so by Theorem \ref{product_mono},
    \[
        \pi_{1 (A \prod B) C} \circ a_i = f.
    \]
    Also,
    \[
        \pi_{2 (A \prod B) C} \circ a_i
        = \pi_3' \circ a_i
        = \pi_{2BC} \circ \pi_{23}' \circ a_i
        = \pi_{2BC} \circ p_{23}
        = p_3.
    \]
    Thus, by Theorem \ref{product_f_uni} in $(A \prod B) \prod C$, $a_1 = a_2$.
\end{proof}

\subsection{Coproducts}

\begin{definition}
    Define a category $C^{AB}$ where the objects are objects $P : C$ with
    morphisms $\iota_{P1} : A \to P$ and $\iota_{P2} : B \to P$.  The morphisms
    in $C^{AB}$ are morphisms $h : P_1 \to P_2$ such that
    \[
        h \circ \iota{P_1 1} = \iota{P_2 1}
    \]
    and
    \[
        h \circ \iota{P_1 2} = \iota{P_2 2}.
    \]
    The composition of these morphisms is the composition of the underlying
    morphism, and the identity morphism is the identity morphism in $C$.
\end{definition}

This is precisely the definition of $C_{AB}$ in the dual category $\dual{C}$,
showing that this is a category.

\begin{class}
    If, for every pair of objects $A$ and $B$ in $C$, there exists an object $A
    \amalg B : C^{AB}$ that is an initial object in $C^{AB}$, we say that $C$
    has coproducts.  That $A \amalg B$ is initial in $C^{AB}$ will be called the
    universal property of $A \amalg B$.
\end{class}

By duality, if $C$ has products, then $\dual C$ has coproducts, and vice versa.
Thus, all of the following theorems can be proven directly from the
corresponding theorems for products by duality.

\begin{theorem} \label{coproduct_f} \label{coproduct_f1} \label{coproduct_f2}
    For any $P : C$ and morphisms $p_1 : A \to P$ and $p_2 : B \to P$, there
    exists a morphism $f : A \amalg B \to P$ such that $f \circ \iota_1 = p_1$
    and $f \circ \iota_2 = p_2$.
\end{theorem}
\begin{proof}
    By duality from Theorem \ref{product_f}.
\end{proof}

\begin{theorem} \label{coproduct_f_uni} \label{coproduct_f_uni2}
    For any $P$ with morphisms $p_1 : A \to P$ and $p_2 : B \to P$, for all
    morphisms $f$ and $g$ in $A \amalg B \to P$, if $f \circ \iota_1 = p_1$, $f
    \circ \iota_2 = p_2$, $g \circ \iota_1 = p_1$, and $g \circ \iota_2 = p_2$,
    then $f = g$.
\end{theorem}
\begin{proof}
    By duality from Theorem \ref{product_f_uni}.
\end{proof}

\begin{theorem} \label{coproduct_epi}
    For all objects $Z : C$ and morphisms $f$ and $g$ in $A \amalg B \to Z$,
    if
    \[
        f \circ \iota_1 = g \circ \iota_1
    \]
    and
    \[
        f \circ \iota_2 = g \circ \iota_2
    \]
    then $f = g$.
\end{theorem}
\begin{proof}
    By duality from Theorem \ref{product_mono}.
\end{proof}

\begin{theorem} \label{coproduct_comm}
    There exists an isomorphism pair $f : A \amalg B \to B \amalg A$ and $g : B
    \amalg A \to A \amalg B$ such that
    \begin{align*}
        f \circ \iota_{2AB} &= \iota_{1BA}, \\
        f \circ \iota_{1AB} &= \iota_{2BA}, \\
        g \circ \iota_{2BA} &= \iota_{1AB}, \\
    \intertext{and}
        g \circ \iota_{1BA} &= \iota_{2AB}.
    \end{align*}
\end{theorem}
\begin{proof}
    By duality from Theorem \ref{product_comm}.
\end{proof}

\begin{theorem} \label{coproduct_assoc}
    Let $\mathcal C$ be a category and $A$, $B$, and $C$ be objects in $\mathcal
    C$.  Then there exists an isomorphism pair $f : A \amalg (B \amalg C) \to (A
    \amalg B) \amalg C$ and $g : (A \amalg B) \amalg C \to A \amalg (B \amalg
    C)$ such that
    \begin{align*}
        f \circ \iota_{1A(B \amalg C)}
            &= \iota_{1(A \amalg B)C} \circ \iota_{1AB}, \\
        f \circ \iota_{2A(B \amalg C)} \circ \iota_{1BC}
            &= \iota_{1(A \amalg B)C} \circ \iota_{2AB}, \\
        f \circ \iota_{2A(B \amalg C)} \circ \iota_{2BC}
            &= \iota_{2(A \amalg B)C}, \\
        g \circ \iota_{1(A \amalg B)C} \circ \iota_{1AB}
            &= \iota_{1A(B \amalg C)}, \\
        g \circ \iota_{1(A \amalg B)C} \circ \iota_{2AB}
            &= \iota_{2A(B \amalg C)} \circ \iota_{1BC}, \\
    \intertext{and}
        g \circ \iota_{2(A \amalg B)C}
            &= \iota_{2A(B \amalg C)} \circ \iota_{2BC}.
    \end{align*}
\end{theorem}
\begin{proof}
    By duality from Theorem \ref{product_assoc}.
\end{proof}

\section{Examples}

\begin{definition}
    The category with $\S$ (the singleton type) as its objects and with $\S$
    being the one morphism in $\S \to \S$ is called the singleton category,
    denoted by $1$.
\end{definition}

\begin{definition}
    Given any category $C$ and object $A : C$, we can define a functor in $1 \to
    C$ that produces the value $A$ and its identity morphism.
\end{definition}

\begin{definition}
    Types form a category where the morphisms are functions, the composition of
    morphisms is the composition of functions, and the identity morphisms are
    the identity functions.  At the possible risk of confusion, we will call
    this category \Type.
\end{definition}

\begin{definition}
    A monoid is a type equipped with a definition of addition and zero such that
    addition is associative and zero is a left and right identity.  A monoid
    homomorphism is a function from a monoid to another monoid that is additive
    and nullitive.  Monoids and their homomorphisms form a category called
    \vtt{Mon}.
\end{definition}

\begin{definition}
    A commutative monoid is a monoid such that addition is commutative.
    Commutative monoid homomorphisms are defined the same as monoid
    homomorphisms are.  Commutative monoids and their homomorphisms form a
    category called \vtt{CMon}.
\end{definition}

\begin{definition}
    A group is a monoid with additive inverses.  A group homomorphism is a
    function from a group to another group that is additive.  Groups and their
    homomorphisms form a category called \vtt{Grp}.
\end{definition}

\begin{definition}
    A commutative group is a group such that addition is commutative.
    Commutative group homomorphisms are defined the same as group homomorphisms
    are.  Commutative groups and their homomorphisms form a category called
    \vtt{CGrp}.  Note that these are usually called Abelian groups by others.
    No offense to Abel, but I like the consistency of using ``commutative'' for
    all commutative versions of structures.
\end{definition}

\begin{definition}
    A rng is a commutative group that also has an associative multiplication
    that distributes over addition.  A rng homomorphism is a function from from
    a rng to another rng that is additive and multiplicative.  Rngs and their
    homomorphisms form a category called \vtt{Rng}.
\end{definition}

\begin{definition}
    A ring is a rng that also has a multiplicative identity.  A ring
    homomorphism is a rng homomorphism that is also unital.  Rings and their
    homomorphisms form a category called \vtt{Ring}.
\end{definition}

\begin{definition}
    A commutative ring is a ring such that multiplication is commutative.
    Commutative ring homomorphisms are defined the same as ring homomorphisms
    are.  Commutative ring and their homomorphisms form a category called
    \vtt{CRing}.
\end{definition}

\begin{definition}
    An integral domain is a commutative ring such that multiplication is
    cancellative.  An integral domain homomorphism is an injective ring
    homomorphism.  Integral domains and their homomorphisms form a category
    called \vtt{Domain}.  Note that morphisms in this category are required to
    be injective.
\end{definition}

\begin{definition}
    An ordered integral domain is an integral domain with a total order that is
    additive and multiplicative.  An ordered integral domain homomorphism is an
    integral domain homomorphism that is orderly.  Ordered integral domains and
    their homomorphisms form a category called \vtt{ODomain}.
\end{definition}

\begin{definition}
    A field is a commutative ring with multiplicative inverses.  A field
    homomorphism is the same thing as a ring homomorphism.  Fields and their
    homomorphisms form a category called \vtt{Field}.
\end{definition}

\begin{definition}
    An ordered field is a field with a total order that is additive and
    multiplicative.  An ordered field homomorphism is a field homomorphism that
    is orderly.  Ordered fields and their homomorphisms form a category called
    \vtt{OField}.
\end{definition}

Because each algebraic structure builds off of other ones (including just
\Type), there exist functors taking more complicated structures to simpler ones
that we call forgetful functors.  There are a few other simple functors we can
define with what we have right now as well.

\begin{definition}
    Given a ring, we can think of multiplication as being a kind of addition,
    which allows us to create a functor from rings to monoids that we call the
    multiplicative monoid of that ring.  Applied to commutative rings, we get a
    commutative monoid.
\end{definition}

\begin{definition}
    Given a field, multiplication of nonzero elements can be considered to be a
    kind of addition as well, and in this case it forms a group.  Thus, we can
    create a functor from fields to commutative groups that we call the
    multiplicative group of that ring.  Note that the underlying set of the
    multiplicative monoid and the multiplicative group of a field are not the
    same, because one includes zero and the other doesn't.
\end{definition}

\begin{theorem}
    The functions taking a type $\U$ to $\L(\U)$ and a function $f : \U \to \V$
    to the function $\L(\U) \to \L(\V)$ given by $f(a)$ for lists $a$ is a
    functor from types to monoids that we call a free functor.
\end{theorem}
\begin{proof}
    We must prove that this functor respects composition and identities.  That
    it respects composition is precisely Theorem \ref{list_image_comp}.  To
    prove that it respects identities, we must prove that for all lists $a$,
    \[
        \1_{\U}(a) = \1_{\L(\U)}(a) = a,
    \]
    which we will do by induction.  When $a = []$, the result is trivial, so the
    base case is true.  Now assume that $\1_{\U}(a) = a$.  Then for all values
    $x : \U$,
    \[
        \1_{\U}(x : a) = \1_{\U}(x) : \1_{\U}(a) = x : a,
    \]
    so the free functor respects identities by induction.
\end{proof}

\begin{theorem}
    The functions taking a type $\U$ to $\L_U(\U)$ and a function $f : \U \to
    \V$ to the function $\L_U(\U) \to \L_U(\V)$ given by $f(a)$ for unordered
    lists $a$ is a functor from types to commutative monoids that we call a free
    functor.
\end{theorem}
\begin{proof}
    The proof is identical in form to the previous theorem.
\end{proof}

\section{Comma Categories}

\begin{theorem}
    Let $A$, $B$, and $C$ be categories with functors $S : A \to C$ and $T : B
    \to C$.  We define the comma category $(S \downarrow T)$ as follows: objects
    are triples $(a, b, f)$ where $a : A$, $b : B$, and $f : S(a) \to T(b)$, and
    the morphisms from $(a, b, f)$ to $(c, d, g)$ are pairs of morphisms $h_1 :
    a \to c$ and $h_2 : b \to d$ such that
    \[
        T(h_2) \circ f = g \circ S(h_1).
    \]
    Identity morphisms are just the pairs $(\1, \1)$.
\end{theorem}
\begin{proof}
    Most of the proofs that this does indeed describe a category are trivial,
    but the one that's a bit more difficult is proving that the composition of
    two of these morphisms is another one.  Let $(a_1, b_1, f_1)$, $(a_2, b_2,
    f_2)$, and $(a_3, b_3, f_3)$ be objects in the comma category with morphisms
    $g_1 : a_2 \to a_3$, $g_2 : b_2 \to b_3$, $h_1 : a_1 \to a_2$, and $h_2 :
    b_1 \to b_2$ such that $T(g_2) \circ f_2 = f_3 \circ S(g_1)$ and $T(h_2)
    \circ f_1 = f_2 \circ S(h_1)$.  Then
    \[
        T(g_2 \circ h_2) \circ f_1
        = T(g_2) \circ T(h_2) \circ f_1
        = T(g_2) \circ f_2 \circ S(h_1)
        = f_3 \circ S(g_1) \circ S(h_1)
        = f_3 \circ S(g_1 \circ h_1).
    \]
\end{proof}

There are many special cases of comma categories that we often use:

\begin{definition}
    Given an object $a : C$, and a functor $T : B \to C$, we define $(a
    \downarrow T)$ to be the comma category $(1_a \downarrow T)$, where $1_a$ is
    the functor from the singleton category to $a$.
\end{definition}

\begin{definition}
    Given a functor $S : A \to C$ and an object $a : C$, we define $(S
    \downarrow a)$ to be the comma category $(S \downarrow 1_a)$, where $1_a$ is
    the functor from the singleton category to $a$.
\end{definition}

\begin{definition}
    Given an object $a : C$, we define the slice category $(C \downarrow a)$ as
    the comma category $(\1 \downarrow 1_a)$, where $1_a$ is the functor from
    the singleton category to $a$.
\end{definition}

\begin{definition}
    Given an object $a : C$, we define the coslice category $(a \downarrow C)$
    as the comma category $(1_a \downarrow \1)$, where $1_a$ is the functor from
    the singleton category to $a$.
\end{definition}

When using each of these definitions, while the singleton type technically
should be playing a role, it doesn't play any role so it wil be dropped in the
future.  Which of these definitions is being used can be determined by the type
of the things in the notation: in $(A \downarrow B)$, if $A$ and $B$ are both
functors, it is the full comma category, if one is a functor and the other is an
object, then it is one of the next two definitions, and if one is a category and
the other is an object, then it is a slice or coslice category.

\subsection{Free Objects} \label{cat_comma_free}

Many free objects can be described using a comma category.  In this section we
will develop a small amount of the general theory of free objects.  Let $B$ and
$C$ be categories, and $T$ a functor from $B$ to $C$ (which we can think of in
this case as being a forgetful functor).  Let $f$ be a function (not a functor)
from $C$ to $B$, and let $g$ be a function from $a : C$ to $a \to T(f(a))$.
Most importantly, assume that for all $a : C$, the pair $(f(a), g(a))$ is
initial in $(a \downarrow T)$.  This property is the universal property of $f$,
and the rest of this section will rely on it.

\begin{definition}
    Given any $a : C$, $b : B$, and $h : a \to T(b)$, by the universal property
    there exists a unique morphism $h' : f(a) \to b$ such that $T(h') \circ g(a)
    = h$, called the extension of $h$.
\end{definition}

\begin{theorem}
    We can extend $f$ to a functor $F : C \to B$ called the free functor by
    bringing morphisms $h : a \to b$ to the extension of $g(b) \circ h$.
\end{theorem}
\begin{proof}
    We must prove that this functor respects composition and the identity.  For
    composition, let $a$, $b$, and $c$ be objects in $C$ with morphisms $h_1 : b
    \to c$ and $h_2 : a \to b$.  Then we have
    \begin{align*}
        &T((g(c) \circ h_1)' \circ (g(b) \circ h_2)') \circ g(a) \\
        ={}& T((g(c) \circ h_1)') \circ T((g(b) \circ h_2)') \circ g(a) \\
        ={}& T((g(c) \circ h_1)') \circ g(b) \circ h_2 \\
        ={}& g(c) \circ h_1 \circ h_2,
    \end{align*}
    showing that $F(h_1) \circ F(h_2)$ satisfies the equation in $F(h_1 \circ
    h_2)$'s universal property, showing that they are equal.

    For uniqueness, let $a : C$.  Then
    \[
        T(\1) \circ g(a) = \1 \circ g(a) = g(a) \circ \1,
    \]
    showing that $\1$ satisfies the equation in $F(\1)$'s universal property,
    showing that they are equal.
\end{proof}

\begin{theorem} \label{free_commute}
    For all objects $a$ and $b$ in $C$ and $h : a \to b$,
    \[
        (T \circ F)(h) \circ g(a) = g(b) \circ h.
    \]
\end{theorem}
\begin{proof}
    Unfolding the definition of $F$ on the left-hand side we get
    \[
        T((g(b) \circ h)') \circ g(a),
    \]
    and the result directly follows from the defining equation of extensions.
\end{proof}

While the free monoid and free commutative monoid functors could be described
using this machinery, I've found that lists are so simple that this is not
necessary.

\section{The Category of Types}

While particular categories will be explored more in the future, because types
have already been described previously, we will explore the category of types
here.

\begin{theorem}
    In \Type, a morphism is a monomorphism if and only if it is injective.
\end{theorem}
\begin{proof}
    Let $\A$ and $\B$ be types with a function $f : \A \to \B$.  First assume
    that $f$ is a monomorphism, and let $a$ and $b$ be values in $\A$ such that
    $f(a) = f(b)$.  Then $f \circ (\lambda \_, a) = f \circ (\lambda \_, b)$,
    and because $f$ is a monomorphism, $\lambda \_, a = \lambda \_, b$.  Thus,
    $a = b$.

    Now assume that $f$ is injective.  Then if $g$ and $h$ are morphisms such
    that $f \circ g = f \circ h$, we must prove that for all $x$, $g(x) = h(x)$.
    Because $f \circ g = f \circ h$, we have $f(g(x)) = f(h(x))$, so the result
    follows from the injectivity of $f$.
\end{proof}

\begin{theorem}
    In \Type, a morphism is an epimorphism if and only if it is surjective.
\end{theorem}
\begin{proof}
    Let $\A$ and $\B$ be types with a function $f : \A \to \B$.  First assume
    that $f$ is an epimorphism, and let $y : \B$.  Define $g : \A \to \Prop$ to
    always have the value \vtt{True}, and define $h : \A \to \Prop$ to be equal
    to $h(z) = \exists a, f(a) = z$.  Note that $g \circ f$ always has the value
    \vtt{True}.  Furthermore, $h \circ f$ is the function $\lambda z, \exists a,
    f(a) = f(z)$, which is also always \vtt{True}.  Thus, $g \circ f = h \circ
    f$, and because $f$ is an epimorphism, $g = h$.  This means that $\exists a,
    f(a) = z$ is always true, so $f$ is surjective.

    Now assume that $f$ is surjective.  Then if $g$ and $h$ are morphisms such
    that $g \circ f = h \circ f$, we must prove that for all $y : \B$, $g(y) =
    h(y)$.  Because $f$ is surjective, there exists an $x$ such that $f(x) = y$.
    Because $g \circ f = h \circ f$, we have $g(f(x)) = h(f(x))$, so $g(y) =
    h(y)$ as required.
\end{proof}

\begin{theorem}
    In \Type, a morphism is an isomorphism if and only if it is bijective.
\end{theorem}
\begin{proof}
    This is a direct consequence of Instance \ref{inverse_ex_bijective} and
    Theorem \ref{bijective_inverse_ex}.
\end{proof}

\begin{theorem}
    \Type has products, which for types $\A$ and $\B$ is given by $\A \times \B$
    and the projection operators $P_1$ and $P_2$.
\end{theorem}
\begin{proof}
    We must prove that $\A \times \B$ satisfies the universal property of
    products, that is, if $\P$ is a type with morphisms $p_1 : \P \to \A$ and
    $p_2 : \P \to \B$, then there exists exactly one morphism $h$ from $\P$ to
    $\A \times \B$ such that $P_1 \circ h = p_1$ and $P_2 \circ h = p_2$.
    For existence, note that $h(x) = (p1(x), p2(x))$ works.  For uniqueness, let
    $a$ and $b$ be morphisms from $\P$ to $\A \times \B$ such that $P_1 \circ a
    = p_1$, $P_2 \circ a = p_2$, $P_1 \circ b = p_1$, and $P_2 \circ b = p_2$.
    This means that $P_1 \circ a = P_1 \circ b$ and $P_2 \circ a = P_2 \circ b$.
    Thus, for all $x : \P$, $P_1(a(x)) = P_1(b(x))$ and $P_2(a(x)) = P_2(b(x))$.
    By the definition of the product type, this means that $a(x) = b(x)$, so $a
    = b$.
\end{proof}

\begin{theorem}
    \Type has coproducts, which for types $\A$ and $\B$ is given by $\A + \B$
    and the constructors of $\A + \B$.
\end{theorem}
\begin{proof}
    Call the constructors of $\A + \B$ $\iota_1$ and $\iota_2$.  We must prove
    that $\A + \B$ satisfies the universal property of coproducts, that is, if
    $\S$ is a type with morphisms $i_1 : \A \to \S$ and $i_2 : \A \to \S$, then
    there exists exactly one morphism $h$ from $\A + \B$ to $\P$ such that $h
    \circ \iota_1 = i_1$ and $h \circ \iota_2 = i_2$.  For existence, we can
    just take a value in $\A + \B$ and if it was constructed from $\A$, set the
    result to $i_1$, and if it was constructed from $\B$, set the result to
    $i_2$.  For uniqueness, let $a$ and $b$ be morphisms from $\A + \B$ to $P$
    such that $a \circ \iota_1 = i_1$, $a \circ \iota_2 = i_2$, $b \circ \iota_1
    = i_1$, and $b \circ \iota_2 = i_2$.  This means that $a \circ \iota_1 = b
    \circ \iota_1$ and $a \circ \iota_2 = b \circ \iota_2$.  Let $x : \A + \B$.
    Then if $x : \A$, from $a \circ \iota_1 = b \circ \iota_1$ we have $a(x) =
    b(x)$, and if $x : \B$, from $a \circ \iota_2 = b\circ \iota_2$ we have
    $a(x) = b(x)$.  Either way, $a(x) = b(x)$, so $a = b$.
\end{proof}

\end{document}
